generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Device {
  id          String       @id @default(uuid())
  deviceId    String       @unique
  name        String?
  firmware    String?
  isOnline    Boolean      @default(false)
  isPaused    Boolean      @default(false)
  lastSeen    DateTime?
  lastDbLevel Float?
  configs     ZoneConfig[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model ZoneConfig {
  id                    String   @id @default(uuid())
  device                Device   @relation(fields: [deviceId], references: [id], onDelete: Cascade)
  deviceId              String
  soundtrackAccountId   String
  soundtrackAccountName String?
  soundtrackZoneId      String
  soundtrackZoneName    String?
  isEnabled             Boolean  @default(false)
  isPaused              Boolean  @default(false)
  minVolume             Int      @default(4)
  maxVolume             Int      @default(12)
  quietThresholdDb      Float    @default(-74)
  loudThresholdDb       Float    @default(-45)
  smoothingFactor       Float    @default(0.2)
  sustainCount          Int      @default(3)
  currentVolume         Int      @default(8)
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt

  @@unique([deviceId, soundtrackZoneId])
}
